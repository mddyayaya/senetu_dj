<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
        <meta http-equiv="page-Enter" content="revealTrans(Duration=3.0,Transition=23)">
		<link rel="stylesheet" type="text/css" href="css/hsqj.css"/>
		<link rel="stylesheet" type="text/css" href="lib/swiper/css/swiper.min.css"/>
		<link rel="stylesheet" type="text/css" href="lib/font-awesome/css/font-awesome.css"/>
		<title>红色全景</title>
	</head>
	<body>
		<!-- 进入页面 -->
		<div class="nav-top" style="margin-top: 2vh;">
			<div class="control1">
				<a href="javascript:history.back();">返回</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="app.html">首页</a>
			</div>
		</div>
		<!-- 列表页面 -->
		<div class="list">
			<!-- 返回 -->
			<div class="animate"></div>
			<div class="animate1"></div>
			<!-- 标题 -->
			<div class="title">红色全景</div>
			<!-- 轮播 -->
			<div id="app" v-cloak>
				<div v-show="isList == true">
					<div>
						<div class="lunbo1 swiper-containter">
							<div class="swiper-wrapper">
								<div class="swiper-slide" v-for="item in ar_list" @click="goAr(item.ar_url)">
									<img :src="'http://st.topics.gmw.cn/p3/sz/ar_img/'+item.ar_h_img" >
								</div>
							</div>
						</div>
						<div class="swiper-button-next swiper-button-next3 next4" style="height: 3vw; width: 3vw;"></div>
						<div class="swiper-button-prev swiper-button-prev3 prev4" style="height: 3vw; width: 3vw;"></div>
					</div>
					<div class="textCont">
						<div class="textTitle">{{ar_title}}</div>
						<div class="textContent">{{ar_content}}</div>
					</div>
				</div>
				<div v-show="isList == false">
					<div class="lunbo swiper-containter">
						<div class="swiper-wrapper">
							<div class="swiper-slide" v-for="item in ar_list" @click="goAr(item.ar_url)">
								<img :src="'http://st.topics.gmw.cn/p3/sz/ar_img/'+item.ar_img" >
							</div>
						</div>
					</div>
					<div class="swiper-button-next swiper-button-next3 next5" style="height: 3vw; width: 3vw;"></div>
					<div class="swiper-button-prev swiper-button-prev3 prev5" style="height: 3vw; width: 3vw;"></div>
				</div>
				<!-- <div class="listMode" @click="changeMode">
					<span>
						<img :src="icon" >
					</span>
					<span>{{text}}</span>
				</div> -->
			</div>
			<!-- 背景音乐 -->
			<div class="bgM anim22"></div>
			<audio src="statics/images/redMap.mp3" hidden="hidden" autoplay="autoplay" ></audio>
		</div>
		<!-- 轮播页面 -->
		<script src="lib/jquery/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="lib/swiper/js/swiper.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/vue.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			var app = new Vue({
				el:'#app',
				data:{
					ar_list:[],
					isList:false,
					ar_title:"",
					ar_content:"",
					icon:"statics/images/listMode.png",
					text:"列表模式"
				},
				methods:{
					// 全景列表
					dataList(){
						var http = 'https://dj.gxsentu.net/';
						var that = this;
						$('.lunbo').hide();
						$.ajax({
							type:'GET',
							dataType:'JSON',
							url:http+'?c=api&m=ar_list',
							success:function(res){
								if(res.status == 200){
									that.ar_list = res.data.cate[9].res;
									that.ar_title = res.data.cate[9].res[0].ar_title;
									that.ar_content = res.data.cate[9].res[0].ar_text;
								}
								setTimeout(function(){
									$('.lunbo').fadeIn(300);
									var personsSwiper = new Swiper('.lunbo1', {
										watchSlidesProgress: true,
										slidesPerView: 5,
										slidesPerGroup:5,
										centeredSlides: true,
										loop: true,
										loopedSlides: 5,
										navigation: {
											nextEl: '.next4',
											prevEl: '.prev4',
										},
										autoplay: {
											delay: 5000,
											stopOnLastSlide: false,
											disableOnInteraction: false,
										},
										observer: true, //修改swiper自己或子元素时，自动初始化swiper
										observeParents: true,
										on: {
											progress: function (progress) {
												for (i = 0; i < this.slides.length; i++) {
													var slide = this.slides.eq(i);
													var slideProgress = this.slides[i].progress;
													modify = 1;
													if (Math.abs(slideProgress) > 1) {
														modify = (Math.abs(slideProgress) - 1) * 0.2 + 1;
													}
													translate = slideProgress * modify *53 + '%';
													scale = 1 - Math.abs(slideProgress) / 5;
													zIndex = 999 - Math.abs(Math.round(10 * slideProgress));
													slide.transform('translateX(' + translate + ') scale(' + scale + ')');
													slide.css('zIndex', zIndex);
													slide.css('opacity', 1);
													if (Math.abs(slideProgress) > 3) {
														slide.css('opacity', 0);
													}
												}
											},
											setTransition: function (transition) {
												for (var i = 0; i < this.slides.length; i++) {
													var slide = this.slides.eq(i)
													slide.transition(transition);
												}
											}
										},
									})
									personsSwiper.on('slideChangeTransitionStart', function () {
										that.ar_title = that.ar_list[personsSwiper.realIndex].ar_title;
										that.ar_content = that.ar_list[personsSwiper.realIndex].ar_text;
									});
									var swiper = new Swiper('.lunbo', {
										slidesPerView: 5,//一行显示3个
										slidesPerColumn: 2,//显示2行
										navigation: {
											nextEl: '.next5',
											prevEl: '.prev5',
										},
										spaceBetween : 50,
										autoplay: {
											delay: 5000,
											stopOnLastSlide: false,
											disableOnInteraction: false,
										},
									})
								},300)
							}
						})
					},
					// 切换模式
					changeMode(){
						var that = this;
						that.isList = !that.isList;
						if(that.isList){
							that.icon = "statics/images/listMode.png",
							that.text = "列表模式"
						}else{
							that.icon = "statics/images/zbmode.png",
							that.text = "展播模式"
						}
						that.dataList();
					},
					goAr(url){
						window.location.href=url
					}
				},
				created() {
					var that = this;
					that.dataList();
				}
			})
			// $(function(){
			// 	// 轮播
			// 	var http = 'https://dj.gxsentu.net/';
			// 	$.ajax({
			// 		type:'GET',
			// 		dataType:'JSON',
			// 		url:http+'?c=api&m=ar_list',
			// 		success:function(res){
			// 			var html="",ar_list = res.data.cate[9].res;
			// 			console.log(ar_list)
			// 			if(res.status == 200){
			// 				for(var i=0;i<ar_list.length;i++){
			// 					html += '<div class="swiper-slide">'+
			// 								'<img src="http://st.topics.gmw.cn/p3/sz/ar_img/"'+ar_list[i].ar_h_img+'" />'+
			// 							'</div>'
			// 				}
			// 			}
			// 			$('.lunbo1 .swiper-wrapper').html(html);
			// 			$('.item').click(function(){
			// 				var url = $(this).attr('value');
			// 				window.location.href=url
			// 			})
			// 			var personsSwiper = new Swiper('.lunbo1', {
			// 			  watchSlidesProgress: true,
			// 			  slidesPerView: 'auto',
			// 			  centeredSlides: true,
			// 			  loop: true,
			// 			  loopedSlides: 5,
			// 			  autoplay: true,
			// 			  navigation: {
			// 				nextEl: '.swiper-button-next',
			// 				prevEl: '.swiper-button-prev',
			// 			  },
			// 			  pagination: {
			// 				el: '.swiper-pagination',
			// 			  },
			// 			  on: {
			// 				progress: function (progress) {
			// 				  for (i = 0; i < this.slides.length; i++) {
			// 					var slide = this.slides.eq(i);
			// 					var slideProgress = this.slides[i].progress;
			// 					modify = 1;
			// 					if (Math.abs(slideProgress) > 1) {
			// 					  modify = (Math.abs(slideProgress) - 1) * 0.3 + 1;
			// 					}
			// 					translate = slideProgress * modify * 260 + 'px';
			// 					scale = 1 - Math.abs(slideProgress) / 5;
			// 					zIndex = 999 - Math.abs(Math.round(10 * slideProgress));
			// 					slide.transform('translateX(' + translate + ') scale(' + scale + ')');
			// 					slide.css('zIndex', zIndex);
			// 					slide.css('opacity', 1);
			// 					if (Math.abs(slideProgress) > 3) {
			// 					  slide.css('opacity', 0);
			// 					}
			// 				  }
			// 				},
			// 				setTransition: function (transition) {
			// 				  for (var i = 0; i < this.slides.length; i++) {
			// 					var slide = this.slides.eq(i)
			// 					slide.transition(transition);
			// 				  }
					
			// 				}
			// 			  }
			// 			})
			// 		}
			// 	})
			// })
		  </script>
	</body>
</html>
