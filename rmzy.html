<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>疫情防控</title>
		<link rel="stylesheet" type="text/css" href="css/yqfk.css"/>
		<link rel="stylesheet" type="text/css" href="lib/font-awesome/css/font-awesome.css"/>
		<link rel="stylesheet" type="text/css" href="css/selectbox.css"/>
		<link rel="stylesheet" type="text/css" href="lib/layui/css/layui.css"/>
	</head>
	<body>
		<div id="app">
			<!-- 头 -->
			<div class="top-nav">
				<div class="control">
					<a href="javascript:history.back(-1)"><i class="fa fa-mail-reply" aria-hidden="true"></i>返回&nbsp;&nbsp;|&nbsp;</a>
					<a href="javascript:window.location='app.html';"><i class="fa fa-home" aria-hidden="true"></i>首页</a>
				</div>
				<div class="list_nav">
					<li :class="topbarSelect == 1?'yellow-color':''" @click="selectData(1)">战略部署</li>
					<li :class="topbarSelect == 2?'yellow-color':''" @click="selectData(2)">"战疫"精神</li>
					<li :class="topbarSelect == 3?'yellow-color':''" @click="selectData(3)">"疫线"人物</li>
					<li :class="topbarSelect == 4?'yellow-color':''" @click="selectData(4)">基层在行动</li>
				</div>
			</div>
			<div class="main_body">
				<div class="wrap">
					<span class="part2">
						<span>搜索</span>
						<span><input v-model="searchBox" class="search" type="text" /><i  @click="search"class="fa fa-search" aria-hidden="true"></i></span>
						<span class="selectbar-open" @click="openSelect"><i class="fa fa-filter" aria-hidden="true"></i>筛选</span>
					</span>
				</div>
				<div class="select-bar" v-show="selectBox == true">
					<div class="layui-form">
					  <div class="layui-form-item">
						<label class="layui-form-label" style="width: 8vw;font-size: 2vh;padding-left: 0;line-height: 3vh;">选择资源类型:</label>
						<div class="layui-input-block">
						  <input type="radio" name="typeSelect" value="" title="全部" checked lay-filter="beshared">
						  <input type="radio" name="typeSelect" value="3" title="视频" lay-filter="beshared">
						  <input type="radio" name="typeSelect" value="4" title="音频" lay-filter="beshared">
						  <input type="radio" name="typeSelect" value="2" title="图文" lay-filter="beshared">
						  <input type="radio" name="typeSelect" value="1" title="PPT" lay-filter="beshared">
						</div>
					  </div>
					</div>
				</div>
				<!-- 主体 -->
				<div class="main-body" id="main-body" :class="selectBox == true?'showTop':''">
					<div class="main-body1">
						<div @click="jumpDetail(item.id,item.bs_id)" class="main-body-item body-item" v-for="item in dataBagList"><a><img :src="item.sz_img"/></a><span>{{item.title}}</span><i class="tips">{{item.bsid1}}</i></div>
					</div>
				</div>
				<div class="null" v-if="dataBagList.length == 0">未找到您要搜索的资源</div>
			</div>
		</div>
	</body>
	<script src="lib/jquery/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/ajax.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/vue.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="lib/layui/layui.js" type="text/javascript" charset="utf-8"></script>
	<script>
		var app = new Vue({
			el:"#app",
			data:{
				// 资源筛选框
				selectBox:false,
				// get数据传参
				getSoucre:{
					template:6,
					ft_id:1,
					bsid:"",
					kw:""
				},
				//顶部导航选中
				topbarSelect:1,
				// 顶部导航选中左侧变化
				topbarSelectWords:"十九届五中全会",
				// 筛选值
				selectNum:0,
				// 空数据
				isNull:false,
				// 搜索框搜索
				searchBox:'',
				// 数据包
				dataBagList:[]
			},
			methods:{
				// 打开筛选框
				openSelect(){
					var that = this;
					that.selectBox = !that.selectBox;
				},
				//顶部资源切换
				selectData(index){
					var that = this;
					that.topbarSelect = index
					that.getSoucre.ft_id =index;
					that.getSoucre.bsid = "";
					that.getSoucre.kw = "";
					that.dataBag();
				},
				// 聚焦搜索
				search(){
					var that = this;
					that.getSoucre.kw = that.searchBox;
					that.dataBag();
				},
				// 资源包
				dataBag(){
					var that = this;
					that.dataBagList = [];
					postData("special",that.getSoucre,function(res){
						if(res.code == 200){
							if(res.data.li.length != 0){
								for(var i=0;i<res.data.li.length;i++){
									if(res.data.li[i].bs_id == 1){
										res.data.li[i].bsid1 = 'PPT'
									}else if(res.data.li[i].bs_id == 2){
										res.data.li[i].bsid1 = '图文'
									}else if(res.data.li[i].bs_id == 3){
										res.data.li[i].bsid1 = '视频'
									}else if(res.data.li[i].bs_id == 4){
										res.data.li[i].bsid1 = '音频'
									}else if(res.data.li[i].bs_id == 8){
										res.data.li[i].bsid1 = 'PDF'
									}
								}
								that.dataBagList = res.data.li;
							}else{
								
							}
						}
					})
				},
				// 详情页跳转
				jumpDetail(id,bsid){
					showDetail(bsid,id,3,1)
				}
			},
			mounted() {
				var that = this;
				// 初始化layui框架
				layui.use(['layer','form'],function(){
					var layer = layui.layer;
					var form = layui.form;
					form.on('radio(beshared)', function (data) {
						that.selectNum = data.value;
						that.getSoucre.bsid = data.value;
						that.dataBag();
						form.render();
					})
				})
			},
			created() {
				var that = this;
				that.dataBag();
				// 回车键搜索
				$(document).keydown(function(event){
					if(event.keyCode == 13){
						that.getSoucre.kw = that.searchBox;
						that.dataBag();
					}
				})
			}
		})
	</script>
</html>
