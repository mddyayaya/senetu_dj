<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>新中国成立70周年</title>
		<link rel="stylesheet" type="text/css" href="css/seventyYears.css"/>
		<link rel="stylesheet" type="text/css" href="lib/font-awesome/css/font-awesome.css"/>
		<link rel="stylesheet" type="text/css" href="lib/layui/css/layui.css"/>
		<link rel="stylesheet" type="text/css" href="css/selectbox.css"/>
		<style type="text/css">
			.top-nav {
			    position: relative;
			    background: url(statics/images/jg-top.png) no-repeat;
			    background-size: 100% 100%;
			    height: 24vh;
			    color: #fff;
			    padding: 2vh 1vw;
			}
		</style>
	</head>
	<body>
		<div id="app" v-cloak>
			<!-- 遮罩 -->
			<div class="blackMark" onclick="closeBag()"></div>
			<!-- 顶部 -->
			<div class="top-nav top-nav1">
				<div class="control">
					<a href="javascript:history.back(-1)"><i class="fa fa-mail-reply" aria-hidden="true"></i>返回&nbsp;&nbsp;|&nbsp;</a>
					<a href="javascript:window.location='app.html';"><i class="fa fa-home" aria-hidden="true"></i>首页</a>
				</div>
			</div>
			<!-- 主体 -->
			<div class="content" id="content">
				<div class="wrap">
					<div class="wrap1">
						<span class="part1" @click="selectBar(1)"><span :class="selectBarIndex == 1?'borderLine':''">辉煌成就</span></span>
						<span class="part1" @click="selectBar(2)"><span :class="selectBarIndex == 2?'borderLine':''">成果与经验</span></span>
						<span class="part1" @click="selectBar(3)"><span :class="selectBarIndex == 3?'borderLine':''">中国精神</span></span>
						<span class="part1" @click="selectBar(4)"><span :class="selectBarIndex == 4?'borderLine':''">迈向新征程</span></span>
					</div>
					<span class="part2">
						<span><a>搜索</a></span>
						<span><input class="search"  v-model="searchBox"  id="val" type="text"/><i  @click="search" class="fa fa-search" aria-hidden="true"></i></span>
						<span class="selectbar-open"  @click="openSelect"><i class="fa fa-filter" aria-hidden="true"></i><a>筛选</a></span>
					</span>
				</div>
				<div class="select-bar" v-show="selectBox == true">
					<div class="layui-form">
					  <div class="layui-form-item">
						<label class="layui-form-label" style="width: 8vw;font-size: 2vh;padding-left: 0;line-height: 3vh;">选择资源类型:</label>
						<div class="layui-input-block">
						  <input type="radio" name="typeSelect" value="0" title="全部" checked lay-filter="beshared">
						  <input type="radio" name="typeSelect" value="4" title="视频" lay-filter="beshared">
						  <input type="radio" name="typeSelect" value="3" title="音频" lay-filter="beshared">
						  <input type="radio" name="typeSelect" value="2" title="图文" lay-filter="beshared">
						  <input type="radio" name="typeSelect" value="1" title="PPT" lay-filter="beshared">
						</div>
					  </div>
					</div>
				</div>
				<!-- 主体 -->
				<div class="main-body" id="main-body" :class="selectBox == true?'showTop':''">
					<div class="main-body1">
						<div class="main-body-item body-item" v-for="item in dataBagList" @click="showDetail(15,item.title,item.ftid,item.id)"><img :src="item.img"/><span>{{item.title}}</span></div>
					</div>
				</div>
				<!-- 展开资源包 -->
				<div class="resource-packages">
					<div class="close-icon" onclick="closeBag()">×</div>
					<div class="select-content">
					<div class="name1">第一批</div>
						<div class="select-content-item">
							<div class="main-body-item body-item1" id="PPT1"><a><img src="statics/images/index1.jpg"/></a><a class="tips">PPT</a><span>习近平新时代中国特色社会主义理论体系</span></div>
						</div>
					</div>
				</div>
			</div>
			<div class="null" v-if="dataBagList.length == 0">未找到您要搜索的内容</div>
		</div>
		<script src="lib/jquery/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/ajax.js" type="text/javascript" charset="utf-8"></script>
		<script src="lib/layui/layui.js" type="text/javascript" charset="utf-8"></script>
		<script src="lib/swiper/js/swiper.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/vue.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			window.onload = function(){
				var app = new Vue({
					el:"#app",
					data:{
						// get数据传参
						getSoucre:{
							template:15,
							ft_id:"",
							kw:""
						},
						selectBox:false,
						// 默认左侧展开
						selectIndex:0,
						// 资源包
						bag:false,
						// 选中导航
						selectBarIndex:1,
						// 搜索框搜索
						searchBox:'',
						// 数据包
						dataBagList:[]
					},
					methods:{
						// 打开筛选框
						openSelect(){
							var that = this;
							if(that.selectBox == true){
								that.selectBox = false;
								that.selectNum = 0
							}else{
								that.selectBox = true
							}
						},
						// 打开资源包
						openBag(){
							var that = this;
							that.bag = true;
						},
						// 导航点击
						selectBar(index){
							var that = this;
							that.selectBarIndex = index;
							that.getSoucre.ft_id = index;
							that.getSoucre.kw = "";
							that.dataBag();
						},
						// 资源包
						dataBag(){
							var that = this;
							that.dataBagList = [];
							postData("clMore",that.getSoucre,function(res){
								if(res.code == 200){
									that.dataBagList = res.data;
								}
							})
						},
						// 打开资源包
						showDetail(template,title,ft_id,rid){
							openBag(template,title,ft_id,rid)
						},
						// 聚焦搜索
						search(){
							var that = this;
							that.getSoucre.kw = that.searchBox;
							that.dataBag();
						},
					},
					mounted() {
						var that = this;
						// 初始化layui框架
						layui.use(['layer','form'],function(){
							var layer = layui.layer;
							var form = layui.form;
							form.on('radio(beshared)', function (data) {
								that.selectNum = data.value;
								that.getSoucre.bsid = data.value;
								that.dataBag();
								form.render();
							})
						})
					},
					created() {
						var that = this;
						var ftid = getUrlParam("ftid");
						var type = getUrlParam("type");
						that.getSoucre.ft_id = ftid;
						that.selectBarIndex = ftid;
						that.dataBag();
						if(type == "isBag"){
							var id = getUrlParam("id");
							var title = getUrlParam("title");
							openBag(5,title,ftid,id)
						}
						// 回车键搜索
						$(document).keydown(function(event){
							if(event.keyCode == 13){
								that.getSoucre.kw = that.searchBox;
								that.dataBag();
							}
						})
					}
				})
			}
		</script>
	</body>
</html>
