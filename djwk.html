<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>党建文库</title>
	</head>
	<link rel="stylesheet" type="text/css" href="css/selectbox.css"/>
	<link rel="stylesheet" type="text/css" href="css/djwkNew.css"/>
	<link rel="stylesheet" type="text/css" href="lib/font-awesome/css/font-awesome.css"/>
	<script src="lib/jquery/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/ajax.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/vue.min.js" type="text/javascript" charset="utf-8"></script>
	<style type="text/css">
		#download{
			position: absolute;
			top: 0;
			right: 0;
			padding: 0.5vh 0;
			width: 5vw;
			text-align: center;
			background: rgba(0,0,0,.6);
			color: #FFF;
			font-size: 1.6vh;
		}
	</style>
	<body>
		<!-- 顶部 -->
			<div class="control">
				<a href="javascript:history.back(-1)"><i class="fa fa-mail-reply" aria-hidden="true"></i>返回&nbsp;&nbsp;|&nbsp;</a>
				<a href="javascript:window.location='app.html';"><i class="fa fa-home" aria-hidden="true"></i>首页</a>
			</div>
		<div id="app" v-cloak>
			<div class="headerNav">
				<div class="logo-word">
					<img src="statics/images/djwk111.png" />
				</div>
				<div class="searchBox">
					<input type="text" v-model="searchBox">
					<span class="searchBtn" @click="search">搜索</span>
				</div>
				<div class="selectBox">
					<div class="selectBox11" :class="showList == true?'autoHeight':''">
						<div class="part" v-for="item in topNavList">
							<div class="title" @click="seletZt(item.ftid,'')"><span>{{item.type}}</span></div>
							<div>
								<p v-for="items in item.ca" :class="getSoucre.wid == items.ftid  &&　getSoucre.ftid == item.ftid?'active':''" @click="seletZt(item.ftid,items.ftid)">{{items.type}}</p>
							</div>
						</div>
					</div>
					<div class="showBtn">
						<i class="fa fa-chevron-down" aria-hidden="true" v-show="showList == false" title="展开" @click="showListSelect"></i>
						<i class="fa fa-chevron-up" aria-hidden="true" v-show="showList == true" title="收起" @click="showListSelect"></i>
					</div>
				</div>
			</div>
			<!-- 搜索结果 -->
			<div class="contentBody" v-if="searchRes == false" :class="showList == true?'showHeight':''">
				<div class="contentItem">
					<div class="img1" @click="jumpDetail(leftText[0].bsid,leftText[0].sid)">
						<img :src="leftText[0].img" alt="">
					</div>
					<div class="img2">
						<div class="imgItem" @click="jumpDetail(leftText[1].bsid,leftText[1].sid)"><img :src="leftText[1].img" alt=""></div>
						<div class="imgItem" @click="jumpDetail(leftText[2].bsid,leftText[2].sid)"><img :src="leftText[2].img" alt=""></div>
					</div>
				</div>
				<div class="contentItem">
					<div class="contentItemList">
						<div class="contentNav"><div>党建文库推荐文章</div></div>
						<ul>
							<li v-for="item in recommendText" @click="jumpDetail(item.bs_id,item.rid)"><img src="statics/images/word.png" alt=""><span>{{item.title}}</span></li>
						</ul>
					</div>
				</div>
				<div class="contentItem">
					<div class="contentItemList contentItemList1">
						<div class="contentNav"><div>党建文库最新文章</div></div>
						<ul>
							<li v-for="item in newText" @click="jumpDetail(item.bs_id,item.rid)"><img src="statics/images/word.png" alt=""><span>{{item.title}}</span></li>
						</ul>
					</div>
					<div class="contentItemList contentItemList2">
						<div class="contentNav"><div>党建文库重点文章</div></div>
						<ul>
							<li v-for="item in importantText" @click="jumpDetail(item.bs_id,item.rid)"><img src="statics/images/word.png" alt=""><span>{{item.title}}</span></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="contentBody contentBodyFlex" v-if="searchRes == true" :class="showList == true?'showHeight':''">
				<div class="djwkItem" v-for="item in dataBagList" @click="jumpDetail(item.bs_id,item.id)">
					<img :src="item.sz_img" >
					<p class="tipss">{{item.title}}</p>
					<span id="download" @click="download(item.ment_url)">下载</span>
				</div>
				<div class="null" v-show="dataBagList == null || dataBagList.length == 0">未找到您要搜索的内容</div>
			</div>
		</div>
	</body>
	<script type="text/javascript">
		window.onload = function(){
			var app = new Vue({
				el:"#app",
				data:{
					// 列表是否展开
					showList:false,
					// 搜索结果
					searchRes:false,
					// 顶部导航
					topNavList:[],
					dataBagList:[],
					// 重点文章
					importantText:[],
					// 最新文章
					newText:[],
					// 推荐文章
					recommendText:[],
					// 左侧文章
					leftText:[],
					// get数据传参
					getSoucre:{
						template:8,
						ftid:"",
						wid:"",
						kw:"",
					},
					searchBox:""
				},
				methods:{
					// 展开列表
					showListSelect(){
						var that = this;
						if(that.showList == true){
							that.showList = false
						}else{
							that.showList = true
						}
					},
					// 顶部导航
					nav(){
						var that = this;
						that.topNavList = [];
						postData("special",that.getSoucre,function(res){
							if(res.code == 200){
								// 导航
								if(res.data.cate.length > 0){
									that.topNavList = res.data.cate;
								}
								// 左侧图片
								if(res.data.left.length > 0){
									for(var i=0;i<res.data.left.length;i++){
										res.data.left[i].img = 'http://'+res.data.left[i].ym+'/'+res.data.left[i].img
									}
									that.leftText = res.data.left
								}
								// 最新文章
								if(res.data.info.news.length > 0){
									that.newText = res.data.info.news;
								}
								// 重点文章
								if(res.data.info.rec.length > 0){
									that.importantText = res.data.info.rec;
								}
								// 推荐文章
								if(res.data.info.imp.length > 0){
									that.recommendText = res.data.info.imp;
								}
								that.dataBag();
							}else{
								
							}
						});
					},
					// 资源包
					dataBag(){
						var that = this;
						that.dataBagList = [];
						postData("djwk_json",that.getSoucre,function(res){
							if(res.code == 200){
								if(res.data.length > 0){
									that.dataBagList = res.data
								}
							}else{
								
							}
						});
					},
					// 选择专题
					seletZt(index,key){
						var that = this;
						that.searchRes = true;
						that.getSoucre.ftid = index;
						that.getSoucre.wid = key;
						that.dataBag();
					},
					// 搜索
					search(){
						var that = this;
						that.searchRes = true;
						that.getSoucre.kw = that.searchBox;
						that.dataBag();
					},
					// 资源详情
					jumpDetail(bsid,id){
						showDetail(bsid,id,3,1)
					},
					download(ment_url){
						window.event.stopPropagation();
						window.location.href = ment_url
						// window.open(ment_url)
					}
				},
				created() {
					var that = this;
					that.nav();
					// 回车键搜索
					$(document).keydown(function(event){
						if(event.keyCode == 13){
							that.searchRes = true;
							that.getSoucre.kw = that.searchBox;
							that.dataBag()
						}
					})
				}
			})
		}
	</script>
</html>
